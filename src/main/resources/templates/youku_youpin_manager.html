<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:score="http://thymeleafexamples">
<head>
  <meta charset="utf-8">
  <title>供应单位定义</title>
  <th:block th:replace="head-css.html"></th:block>
  <th:block th:replace="head-js.html"></th:block>
  <style> .display{
            text-align: center
        }
 	.dataTables_filter{
 		width:10px;
 		position:absolute; 	
 		top:-40px;
 		left:10%;
 	}
 	/* #toolbar{
 		position:relative;
 		top:0px;
 		left:74%;
 	} */
 	 .box-title{
 		position:relative;
 		top:10px;
 	} 
  </style>
 </head>
<body>	
<div class="row">
<div class="col-md-6">  
<div class="box">        
<div class="box-header with-border">
<table class="box-title">
<tr><td style="width:30%"><h4>油库定义</h4></td>
    <td style="width:20%">
        <select id="oil_depot_select" class="form-control selectpicker "  data-style="btn-info">       
        </select>
    </td>
    <td style="width:10%">
        <button id="add_oil_depot" class="btn btn-info btn-block">添加</button>
    </td>
    <td style="width:10%">
        <button id="del_oil_depot" class="btn btn-info btn-block">删除</button>
    </td>
   <!--  <td>
    <input type="text" class="input-mini form-control" id="departCode" placeholder="自定义油库">
    </td> -->
</tr>
</table>

</div>
<div class="box-body with-border">
	<table id="oil_depot_table" class="table table-hover table-stripe table-bordered table-condensed">
	<thead>	
		<tr style="font-size:16px;background-color:rgb(237, 241, 244);align:center">
		<th style="width:10%">序号</th>
		<th style="width:15%">代码</th>
		<th style="width:20%">名称</th>
		<th style="width:10%">类型</th>
		</tr>
	</thead>
	</table>	
</div></div></div>
<div class="col-md-6">   
<div class="box">        
<div class="box-header with-border">

<table class="box-title">
<tr>
<td style="width:30%">
<h4 >油品定义</h4>
</td>
<td style="width:20%">
    <select id="oil_type_select" class="form-control selectpicker "  data-style="btn-info">       
    </select>
</td>
<td style="width:10%">
    <button id="add_oil_type"  class="btn btn-info btn-block">添加</button>
</td>
<td style="width:10%">
    <button id="del_oil_type"  class="btn btn-info btn-block">删除</button>
</td>
</tr>
</table>
</div>
<div class="box-body with-border">
	<table id="oil_type_table" class="table table-hover table-stripe table-bordered table-condensed">
	<thead>	
		<tr style="font-size:16px;background-color:rgb(237, 241, 244);align:center">
		<th style="width:10%">序号</th>
		<th style="width:20%">代码</th>
		<th style="width:20%">名称</th>
		<th style="width:10%">标志</th>	
		</tr>
	</thead>
	</table>	
</div>
</div>
</div>
</div>
<!-- <th:block th:include="head-js.html"></th:block> -->
<script type='text/javascript' th:inline="javascript">
$(function(){	
	var oil_depot_table;
	var oil_type_table;
	function load_oil_depot_table(){
		oil_depot_table.ajax.reload();
	}
	function load_oil_type_table(){
		oil_type_table.ajax.reload();
	}
	function init_oil_type_table(){
		oil_type_table=$('#oil_type_table').DataTable({
			 	"pagingType":   "full",
			 	"jQueryUI": false,
				'pageLength' : 10,
				'lengthChange' : false,
				'searching' : false,
				'info' : true,
				'autoWidth' : false,
			  	"bDestroy":true,
		   		"bRetrieve":true,   		 
		   		"select": {
		   	        style: 'single',
		   	        info: ''
		   	    },   	   
		   	    "sort": true,
		   	 	//"order": [1,'asc'],  	
			  	"aoColumnDefs":[{"bSortable": false,"aTargets":[1,2,3]}],
			  	"ajax": "oil_type_manager/datas",
			  	"columns": [
			  		{ "data": "id"},
			  		{ "data": "code"},
		            { "data": "name"},
		            { "data": "flag"}
		        ],
		    	"oLanguage": { //国际化配置  
					"sProcessing" : "正在获取数据，请稍候...",    
					"sLengthMenu" : "显示 _MENU_ 条",    
					"sZeroRecords" : "没有您要搜索的内容",    
					"sInfo" : "从 _START_ 到  _END_  共 _TOTAL_ 条",    
					"sInfoEmpty" : "记录数为0",    
					"sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
					"sInfoPostFix" : "",    
					"sSearch" : "查询",
					"sUrl" : "",    
					"oPaginate": {    
						"sFirst" : "首页",    
						"sPrevious" : "<<",    
						"sNext" : ">>",    
						"sLast" : "尾页"    
					}
		    	}    	
			});		
	}
	function init_oil_depot_table(){
		oil_depot_table=$('#oil_depot_table').DataTable({
    		"pagingType":   "full",
			'pageLength' : 10,
			'lengthChange' : false,
			'searching' : false,
			'info' : true,
			'autoWidth' : false,
	  		"bDestroy":true,
   			"bRetrieve":true,   		 
   			"select": {
   	        	style: 'single',
   	        	info: ''
   	    	},   	   
   	    	"sort": true,
   	 		//"order": [1,'asc'],  	
	  		"aoColumnDefs":[{"bSortable": false,"aTargets":[1,2,3]}],
	  		"ajax": "oil_depot_manager/datas",
	  		"columns": [
	  			{ "data": "id"},
	  			{ "data": "youku_code"},
            	{ "data": "youku"},
            	{ "data": "leixing"}/* ,
            	{ "data": "biaozhi"},
            	{ "data": "paixu"} */
        	],
    		"oLanguage": { //国际化配置  
			"sProcessing" : "正在获取数据，请稍后...",    
			"sLengthMenu" : "显示 _MENU_ 条",    
			"sZeroRecords" : "没有您要搜索的内容",    
			"sInfo" : "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",    
			"sInfoEmpty" : "记录数为0",    
			"sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
			"sInfoPostFix" : "",    
			"sSearch" : "查询",
			"sUrl" : "",    
			"oPaginate": {    
				"sFirst" : "首页",    
				"sPrevious" : "<<",    
				"sNext" : ">>",    
				"sLast" : "尾页"    
			}
    	}    	
	});
	}
    function load_oil_depot_list(){
    	$.ajax({
    		url:"oil_depot_manager/getunuse",
    		type: 'get',    		
    		success:function(data){
    			$("#oil_depot_select option").remove();
    			oil_depot=$("#oil_depot_select");
    			oil_depot.append("<option value='all'>请选择油库</option>"); 
    			data.forEach(function(e){
    				oil_depot.append("<option value='"+e.youku_code+"'>"+e.youku+"</option>");
    			})
			}
    	});	
    }
    function load_oil_type_list(){
    	$.ajax({
    		url:"oil_type_manager/getunuse",
    		type: 'get',    		
    		success:function(data){
    			$("#oil_type_select option").remove();
    			oil_depot=$("#oil_type_select");
    			oil_depot.append("<option value='all'>请选择油品</option>"); 
    			data.forEach(function(e){
    				oil_depot.append("<option value='"+e.code+"'>"+e.name+"</option>");
    			})
			}
    	});	
    }
    load_oil_depot_list();
    load_oil_type_list();
    init_oil_depot_table();
    init_oil_type_table();
    //添加一条记录
    $('#add_oil_depot').on('click',function(){
    	var youkucode=$("#oil_depot_select").val();
    	if(youkucode=='all'){
    		alert_advance_info('请选择油库');
    		return;
    	}
    	$.ajax({
    		url:"oil_depot_manager/edit",
    		type: 'post',
    		data:{"action":"add","youku_code":youkucode},
    		success:function(result){
				alert_advance_info(result);
				//table.draw( true );
				//loadtable();
				//loadList();
				//table.draw(true);
				load_oil_depot_list();
			    load_oil_depot_table();
			}
    	});
    });
    //删除一条记录
    $('#del_oil_depot').on('click',function(){
       	var code;
    	var name;
    	var rows=$("#oil_depot_table").find(".selected").children('td');
   	
    	rows.each(function(j){
    		switch(j){    		
    		case 1: code=$(this).text();break;
    		case 2: name=$(this).text();break;
    		}
    	});
    	if(code==null){
    		alert_advance_info('请选择一行'); 
    		return;
    	}
    	$.ajax({
    		url:"oil_depot_manager/edit",
    		type: 'post',
    		data:{"action":"del","youku_code":code},
    		success:function(data){
				alert_advance_info(data);
				//table.row('.selected').remove().draw( false );
				//loadList();
				//loadtable();
				//loadtable();
				load_oil_depot_list();
			    load_oil_depot_table();
			}
    	});    	
    });
    //添加一条记录
    $('#add_oil_type').on('click',function(){
    	var code=$("#oil_type_select").val();
    	if(code=='all'){
    		alert_advance_info('请选择油品');
    		return;
    	}
    	$.ajax({
    		url:"oil_type_manager/edit",
    		type: 'post',
    		data:{"action":"add","code":code},
    		success:function(result){
				alert_advance_info(result);
				//table.draw( true );
				//loadtable();
				//loadList();
				//table.draw(true);
				load_oil_type_list();
			    load_oil_type_table();
			}
    	});
    });
    //删除一条记录
    $('#del_oil_type').on('click',function(){
       	var code;
    	var name;
    	var rows=$("#oil_type_table").find(".selected").children('td');
   	
    	rows.each(function(j){
    		switch(j){    		
    		case 1: code=$(this).text();break;
    		case 2: name=$(this).text();break;
    		}
    	});
    	if(code==null){
    		alert_advance_info('请选择一行'); 
    		return;
    	}
    	$.ajax({
    		url:"oil_type_manager/edit",
    		type: 'post',
    		data:{"action":"del","code":code},
    		success:function(data){
				alert_advance_info(data);
				//table.row('.selected').remove().draw( false );
				//loadList();
				//loadtable();
				//loadtable();
				load_oil_type_list();
			    load_oil_type_table();
			}
    	});    	
    });
})
</script>
</body>
</html>
